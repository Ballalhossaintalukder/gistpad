<form action="https://codepen.io/pen/define" method="POST">
  <input type="hidden" name="data" />
</form>

<script>
  const pen = window.location.search.replace("?pen=", "");

  if (pen) {
    const metadataUrl = decodeURIComponent(pen);

    const xhr = new XMLHttpRequest();
    xhr.setRequestHeader(
      "cache-control",
      "no-cache, must-revalidate, post-check=0, pre-check=0"
    );
    xhr.setRequestHeader("cache-control", "max-age=0");
    xhr.setRequestHeader("expires", "0");
    xhr.setRequestHeader("expires", "Tue, 01 Jan 1980 1:00:00 GMT");
    xhr.setRequestHeader("pragma", "no-cache");

    xhr.open("GET", metadataUrl);
    xhr.onload = () => {
      if (xhr.status == 200) {
        const response = xhr.response.replace(/"/g, "&quot;");

        document
          .querySelector("input[type='hidden']")
          .setAttribute("value", response);

        document.querySelector("form").submit();
      }
    };

    xhr.send();
  }
</script>
